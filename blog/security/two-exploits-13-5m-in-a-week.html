<!DOCTYPE html>
<html lang="en">
    <head>
        <!-- meta tags -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">

    <title>$13.3M Lost in a Week: Two Protocol Exploits</title>
    <meta name="description"
        content="Two DeFi exploits drained $13.3M in a week—root causes, attack paths, timelines, on-chain evidence, fixes, and preventive controls developers can apply.">
    <meta name="keywords"
        content="DeFi, Exploits, Uniswap, BetterBank,  smart contract security, Ethereum security, Web3 security, exploit analysis, hack postmortem, incident response, on-chain forensics, transaction trace, vulnerability, attack vector, protocol exploit, protocol hack, $13.3M loss, two exploits one week, root cause analysis, remediation, mitigation, best practices, secure coding, Solidity security, reentrancy, re-entrancy, access control bug, unauthorized access, role misconfiguration, RBAC, Ownable, Pausable, timelock, pause guardian, circuit breaker, flash loan, flashloan attack, price oracle manipulation, oracle spoofing, TWAP, unsafe oracle, MEV, front-running, sandwich attack, slippage manipulation, signature replay, permit abuse, EIP-2612, EIP-712, unchecked return value, integer overflow, integer underflow, arithmetic bug, unchecked call, delegatecall risk, selfdestruct risk, tx.origin misuse, timestamp dependency, randomness weakness, upgradeable proxy, TransparentUpgradeableProxy, UUPS, Beacon proxy, Diamond pattern, storage collision, initialization bug, proxy upgrade risk, emergency shutdown, bug bounty, disclosure, audit findings, audit remediation, static analysis, dynamic analysis, fuzz testing, invariant testing, formal verification, unit tests, Foundry, Hardhat, Slither, Echidna, Mythril, Tenderly, Etherscan, OpenZeppelin, code review, gas optimization, defense in depth, threat modeling, risk management, TVL drain, liquidity pool exploit, approval phishing, allowance escalation, access list, multisig safeguards, monitoring, alerting, anomaly detection, postmortem, lessons learned, secure smart contract">
    <meta name="author" content="Sasha Flores">
    <meta property="og:type" content="website">

    

    <!-- Bootstrap CSS -->
    <link href="../../css/bootstrap.min.css" rel="stylesheet">
    <link href="../../css/aos.css" rel="stylesheet">
    <link href="../../css/navbar.css" rel="stylesheet">
    <link href="../../css/new-common-articles.css" rel="stylesheet">
    <link href="../../css/blog/security/two-exploits-13-5m-in-a-week.css" rel="stylesheet">
    <link href="../../css/footer.css" rel="stylesheet">

    


    <script async src="https://www.googletagmanager.com/gtag/js?id=G-MXTX916K7T"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-MXTX916K7T');
    </script>
    </head>


    <body class="page-offset">
        <i class="bi bi-list mobile-nav-toggle d-xl-none"></i>
    <header>
        <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
            <div class="container-fluid px-md-5">
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                    data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                    aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0" data-aos="fade-down" data-aos-duration="1000">
                        <li class="nav-item">
                            <a class="nav-link" aria-current="page" href="../../index.html">HOME</a>
                        </li>

                        <li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="#" id="aboutDropdown"
                                role="button" data-bs-toggle="dropdown" aria-expanded="false">ABOUT ME</a>
                            <ul class="dropdown-menu" aria-labelledby="aboutDropdown">
                                <li><a class="dropdown-item" href="../../background.html">Background</a></li>
                                <li><a class="dropdown-item" href="../../skills.html">Skills</a></li>
                                <li><a class="dropdown-item" href="../../experience.html">Experience</a></li>
                            </ul>
                        </li>
                        <li class="nav-item"><a class="nav-link" href="../../portfolio.html">PORTFOLIO</a></li>
                        <li class="nav-item"> <a class="nav-link active" href="../blog.html">BLOG</a></li>
                        <li class="nav-item"><a class="nav-link" href="../../contact.html">CONTACT</a></li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>
    <div class="article-container">
        <h1 id="title">Two Exploits in a Span of a Week: How $13.3M Vanished Across BetterBank & Bunni v4</h1>
        <figure class="meta-video">
            <video class="article-hero-video" autoplay muted loop playsinline preload="auto"
                aria-label="Looping hero animation">
                <source src="../../images/blog/security/two-exploits-13-5m-in-a-week/animation.mp4" type="video/mp4">
            </video>
        </figure>

        <p>
            On Aug 27, BetterBank on PulseChain was drained for about $5M. The root mistake was privilege control around 
            minting and supply management. An attacker gained a path to create value without proper checks, inflated supply, 
            then swapped out into liquid assets and exited while balances and limits failed to stop the flow.
        </p>
        <p>
            On Sep 2, Bunni v2 built on Uniswap v4 lost about $8.3M. The weakness lived in hook logic and accounting. 
            By steering calls through a v4 hook at carefully chosen moments, the attacker broke expected invariants around 
            liquidity updates and deltas, turning bookkeeping gaps into real withdrawals.
        </p>
        <p>
            This post walks both incidents end to end — what each protocol intended to guarantee, what preconditions the 
            attacker needed, the exact call traces that moved state in their favor, and the minimal fixes that would have 
            closed the doors — stricter role gates and supply caps for BetterBank, and hook-safe accounting, delta checks, 
            and reentrancy boundaries for Bunni v2.
        </p>
        <h2 class="title t-2">BetterBank Exploit</h2>
        <p>
            <a href="https://dapp.betterbank.io/" target="_blank" rel="noopener noreferrer">BetterBank</a> is a revolutionary DeFi 
            protocol that reimagine lending, borrowing, and wealth generation on PulseChain with two native tokens Esteem `$ESTEEM`— 
            is the primary governance and ownership token and Favor starting with `$PDAIF`, `$PLSF`, and `$PLSXF`— designed to power 
            the lending and borrowing ecosystem.
        </p>
        <h3 class="title t-3">Esteem Token</h3>
        <ul>
            <li>Holding and staking Esteem Enables Favor issuance.</li>
            <li>Users can mint Esteem at a perpetually increasing price.</li>
            <li>Purchasing Favor rewards users with an Esteem bonus equal to 44% of the Favor purchase value.</li>
            <li>Depositors in BetterBank’s Stronghold lending pools receive Esteem as a reward for supplying liquidity.</li>
        </ul>
        <h3 class="title t-3">Favor Token</h3>
        <ul>
            <li>
                Favor is minted through staking Esteem. The rate of minting is market-driven, meaning
                Favor supply growth expands when demand is high and contracts when demand is low.
            </li>
            <li>
                Favor’s daily minting rate varies based on its ratio to its paired asset; If a Favor
                type trades at 3x its paired asset or more, 3% of its total supply is minted.
            </li>
            <li>
                Since Esteem is illiquid users may choose to smelt (burn) their Esteem for 70% of its
                value in (newly minted) Favor tokens of choice.
            </li>
        </ul>
        <h3 class="title t-3">Hack Analysis</h3>
        <p>
            The attacker abused BetterBank’s automated distribution system by purchasing Favor to gain Esteem at 44% of Favor’s purchasing 
            value as rewards in addition to Favor's daily minting rate, he successfully drained 891M DAI. 9.05B PLSX, and 7.40B WPLS.
        </p>
        <p>
            <strong>First, he created 3 malicious contracts:</strong>
            <ul>
                <li>First Contract</li>
                <ul>
                    <li>EOA: 0x48c9f537f3f1a2c95c46891332E05dA0D268869B</li>
                    <li>Tx Hash: 0x9c7237a00fa276c5f10ca1c61d6821869a7fdcd1ade8059729cdc35c9ff7689a</li>
                    <li>Contract Address: 0x18Dd9E3F039F319c854c389fC87b5295d3cb7f94</li>
                    <figure class="meta">
                        <img alt="" src="../../images/blog/security/two-exploits-13-5m-in-a-week/BB-1.png" />
                    </figure>
                </ul>
            </ul>
            <ul>
                <li>Second Contract</li>
                <ul>
                    <li>EOA: 0x48c9f537f3f1a2c95c46891332E05dA0D268869B</li>
                    <li>Tx Hash: 0xc651656d2f94476374ee1de240f6bcf4572a5fe732db92d319573a1727409f82</li>
                    <li>Contract Address: 0x767C5a70CDa0D9469ccE3a56653E1d170D9849c3</li>
                    <figure class="meta">
                        <img alt="" src="../../images/blog/security/two-exploits-13-5m-in-a-week/BB-2.png" />
                    </figure>
                </ul>
            </ul>
            <ul>
                <li>Third Contract</li>
                <ul>
                    <li>EOA: 0x48c9f537f3f1a2c95c46891332E05dA0D268869B</li>
                    <li>Tx Hash: 0x74534b1f86a63c6c722d5845f2b4c08867c2e66b922a6c95cd6b4290664c19bd</li>
                    <li>Contract Address: 0x792CDc4adcF6b33880865a200319ecbc496e98f8</li>
                    <figure class="meta">
                        <img alt="" src="../../images/blog/security/two-exploits-13-5m-in-a-week/BB-3.png" />
                    </figure>
                </ul>
            </ul>
        </p>
        <p>
            <strong>
                Second, with one of the first contract, he borrowed 50M DAI and 7.14B PLP tokens from
                the flash loan he initiated on BetterBank’s DAI-PDAIF pair.
            </strong>
            <figure class="meta">
                <img alt="" src="../../images/blog/security/two-exploits-13-5m-in-a-week/BB-4.png" />
            </figure>
        </p>
        <p>
            <strong>
                Third, 7.14B PLP he borrowed, invoked `removeLiquidity` on `PulseXRouter02` that 
                drained real DAI-PDAIF pool from 1B DAI and 500M PDAIF.
            </strong>
            <figure class="meta">
                <img alt="" src="../../images/blog/security/two-exploits-13-5m-in-a-week/BB-5.png" />
            </figure>
        </p>
        <p>
            <strong>
                Fourth, attacker using a fake token to create a new fake-PDAIF pool on PulseXFactory, minting a quintillion of this fake token 
                while adding minimal liquidity of fake token and draining PDAIF.
            </strong>
            <figure class="meta">
                <img alt="" src="../../images/blog/security/two-exploits-13-5m-in-a-week/BB-6.png" />
            </figure>
        </p>
        <p>
            <strong>
                Fifth, using this fake token he executed several swaps in the same fake he created to simulate high trading volume 
                and mint Esteem rewards multiple times.
            </strong>
            <figure class="meta">
                <img alt="" src="../../images/blog/security/two-exploits-13-5m-in-a-week/BB-7.png" />
            </figure>
            </strong>
            <figure class="meta">
                <img alt="" src="../../images/blog/security/two-exploits-13-5m-in-a-week/BB-9.png" />
            </figure>
        </p>
        <p>
            <strong>
                Sixth, he converted all Esteem rewards to almost 3.8B PDAIF which results in inflating PDAIF token supply.
            </strong>
            <figure class="meta">
                <img alt="" src="../../images/blog/security/two-exploits-13-5m-in-a-week/BB-10.png" />
            </figure>
        </p>
        <p>
            <strong>
                Seventh, he used part of PDAIF gains to add liquidity into DAI-PDAIF pool with almost 1.09B DAI and 501M PDAIF,
                resulting in imbalanced pool with excess PDAIF.
            </strong>
            <figure class="meta">
                <img alt="" src="../../images/blog/security/two-exploits-13-5m-in-a-week/BB-11.png" />
            </figure>
        </p>
        <p>
            <strong>
                Eighth, he exploited the imbalanced he created in DAI-PDAIF pool to swap the surplus PDAIF for 891M DAI, to pay 
                the original flash loan of DAI-PLP back to BetterBank and retained around 891M DAI.
            </strong>
            <figure class="meta">
                <img alt="" src="../../images/blog/security/two-exploits-13-5m-in-a-week/BB-12.png" />
            </figure>
        </p>
        <p><strong>He managed to repeat the same scheming exploit and successfully retained around 9B PLSX and 7.4B WPLS</strong></p>
        <h3 class="title t-3">How this Exploit Can be Avoided</h3>
        <ul>
            <li><strong>Interchangeable Rewards Mechanism:</strong> allows Esteem reward holders to convert it to Favor that result in supply inflation.</li>
            <li>
                <strong>Flawed Reward Logic in `SwapExactTokensForFavorAndTrackBonus`:</strong> it only verifies the output swap is Favor which triggers Esteem 
                minting as reward, but it doesn't validate whether the swap took place through a legitimate pool.
            </li>
        </ul>
        <h3 class="title t-3">References and Related Links</h3>
        <ul>
            <li>BetterBank Custom Contracts:
                <a href="https://github.com/grape-finance/BB-Custom-contracts" target="_blank" rel="noopener noreferrer">GitHub</a>
            </li>
            <li>
                Tx Hash of Attacker's First Contract Creation:
                <a href="https://otter.pulsechain.com/tx/0x9c7237a00fa276c5f10ca1c61d6821869a7fdcd1ade8059729cdc35c9ff7689a" target="_blank" rel="noopener noreferrer">PulseChain Explorer</a>
            </li>
            </li>
            <li>
                Tx Hash of Attacker's Second Contract Creation:
                <a href="https://otter.pulsechain.com/tx/0xc651656d2f94476374ee1de240f6bcf4572a5fe732db92d319573a1727409f82" target="_blank" rel="noopener noreferrer">PulseChain Explorer</a>
            </li>
            </li>
            <li>
                Tx Hash of of Attacker's Third Contract Creation:
                <a href="0x74534b1f86a63c6c722d5845f2b4c08867c2e66b922a6c95cd6b4290664c19bd" target="_blank" rel="noopener noreferrer">PulseChain Explorer</a>
            </li>
            <li>
                List of Attacker's Token Transfers:
                <a href="https://scan.9mm.pro/tx/0xc651656d2f94476374ee1de240f6bcf4572a5fe732db92d319573a1727409f82?tab=token_transfers" target="_blank" rel="noopener noreferrer">PulseChain Explorer</a>
            </li>
            <li>
                ESTEEM Contract:
                <a href="https://scan.mypinata.cloud/ipfs/bafybeih3olry3is4e4lzm7rus5l3h6zrphcal5a7ayfkhzm5oivjro2cp4/#/address/0xdbB8Fd196E804d05bb8047Dd3e91a9245B7819a7?tab=contract
" target="_blank" rel="noopener noreferrer">PulseChain Explorer</a>
            </li>
            <li>
                PulseXRouter02:
                <a href="https://otter.pulsechain.com/address/0x165C3410fC91EF562C50559f7d2289fEbed552d9/contract" target="_blank" rel="noopener noreferrer">PulseChain Explorer</a>
            </li>

            <li>
                DAI Contract:
                <a href="https://scan.mypinata.cloud/ipfs/bafybeih3olry3is4e4lzm7rus5l3h6zrphcal5a7ayfkhzm5oivjro2cp4/#/token/0x6B175474E89094C44Da98b954EedeAC495271d0F?tab=read_contract" target="_blank" rel="noopener noreferrer">PulseChain Explorer</a>
            </li>
            <li>
                Wrapper PLS Contract:
                <a href="https://scan.mypinata.cloud/ipfs/bafybeih3olry3is4e4lzm7rus5l3h6zrphcal5a7ayfkhzm5oivjro2cp4/#/token/0xA1077a294dDE1B09bB078844df40758a5D0f9a27" target="_blank" rel="noopener noreferrer">PulseChain Explorer</a>
            </li>
            <li>
                PulseX Contract:
                <a href="https://scan.mypinata.cloud/ipfs/bafybeih3olry3is4e4lzm7rus5l3h6zrphcal5a7ayfkhzm5oivjro2cp4/#/token/0x95B303987A60C71504D99Aa1b13B4DA07b0790ab" target="_blank" rel="noopener noreferrer">PulseChain Explorer</a>
            </li>

            <li>
                BetterBank Documentations:
                <a href="https://betterbanks-organization.gitbook.io/better-bank" target="_blank" rel="noopener noreferrer">Docs</a>
            </li>
            
        </ul>
        
    </div>

    <footer>
        <div class="footer-content">
            <p>&copy; 2025 Sasha Flores. All Rights Reserved.</p>
            <div class="social-links">
                <a href="https://www.linkedin.com/in/sflores369/" target="_blank"><ion-icon
                        name="logo-linkedin"></ion-icon></a>
                <a href="https://discord.com/users/827160247428710422" target="_blank"><ion-icon
                        name="logo-discord"></ion-icon></a>
                <a href="https://github.com/SashaFlores" target="_blank"><ion-icon name="logo-github"></ion-icon></a>
                <a href="https://www.youtube.com/@web3securityengineer" target="_blank"><ion-icon name="videocam-sharp"></ion-icon><span class="tooltip"></span></a>
            </div>
        </div>
    </footer>
    
    
    
    <script src="../../js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="../../js/aos.js"></script>
    <script src="../../js/custom.js"></script>
    <script src="../../js//code-copy.js"> </script>
    
    <script type="module" src="https://unpkg.com/ionicons@latest/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule="" src="https://unpkg.com/ionicons@latest/dist/ionicons/ionicons.js"></script>
    

    </body>
    
</html>