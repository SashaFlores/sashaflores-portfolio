<!DOCTYPE html>
<html lang="en">
    <head>
        <!-- meta tags -->
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta content="width=device-width, initial-scale=1.0" name="viewport">
    
        <title>New Gold Protocol Hack Analysis Price Oracle Manipulation</title>
        <meta name="description"
            content="A flash loan exploit drained $2M from NGP token on BNB Chain. Price oracle manipulation enabled large token acquisition at manipulated prices.">
        <meta name="keywords"
            content="DeFi, exploits, binance, flash loans,  smart contract security, oracle price manipulation, exploit analysis, hack postmortem, incident response, price manipulation, transaction trace, vulnerability, attack vector, protocol exploit, protocol hack, $2M loss NGP, Sep 18th 2025 attack, root cause analysis, remediation, mitigation, best practices, secure coding">
        <meta name="author" content="Sasha Flores">
        <meta property="og:type" content="website">
    
    
    
        <!-- Bootstrap CSS -->
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/aos.css" rel="stylesheet">
        <link href="../../css/navbar.css" rel="stylesheet">
        <link href="../../css/new-common-articles.css" rel="stylesheet">
        <link href="../../css/footer.css" rel="stylesheet">




        <script async src="https://www.googletagmanager.com/gtag/js?id=G-MXTX916K7T"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag() { dataLayer.push(arguments); }
            gtag('js', new Date());

            gtag('config', 'G-MXTX916K7T');
        </script>
        
    </head>

    <body class="page-offset">
        <i class="bi bi-list mobile-nav-toggle d-xl-none"></i>
    <header>
        <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
            <div class="container-fluid px-md-5">
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                    data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                    aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0" data-aos="fade-down" data-aos-duration="1000">
                        <li class="nav-item">
                            <a class="nav-link" aria-current="page" href="../../index.html">HOME</a>
                        </li>

                        <li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="#" id="aboutDropdown"
                                role="button" data-bs-toggle="dropdown" aria-expanded="false">ABOUT ME</a>
                            <ul class="dropdown-menu" aria-labelledby="aboutDropdown">
                                <li><a class="dropdown-item" href="../../background.html">Background</a></li>
                                <li><a class="dropdown-item" href="../../skills.html">Skills</a></li>
                                <li><a class="dropdown-item" href="../../experience.html">Experience</a></li>
                            </ul>
                        </li>
                        <li class="nav-item"><a class="nav-link" href="../../portfolio.html">PORTFOLIO</a></li>
                        <li class="nav-item"> <a class="nav-link active" href="../blog.html">BLOG</a></li>
                        <li class="nav-item"><a class="nav-link" href="../../contact.html">CONTACT</a></li>
                    </ul>

                    <div class="nav-cta">
                        <button type="button" class="nav-cta__btn" data-connect-trigger aria-haspopup="dialog" aria-controls="walletModal">CONNECT</button>
                        <button type="button" class="nav-cta__btn nav-cta__btn--accent" data-subscribe-trigger aria-haspopup="dialog" aria-controls="subscribeModal">SUBSCRIBE</button>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <div class="article-container">
        <h1 id="title">New Gold Protocol Hack Analysis<br> Price Oracle Manipulation</h1>
        <figure class="meta">
            <img alt="OraclePrice" src="../../images/blog/security/new-gold-protocol-hack-analysis/oracle.png" />
        </figure>

        <div class="article-stats" data-post-id="gold-protocol">
            <button type="button" class="stat" data-role="like">
                <ion-icon name="thumbs-up-outline"></ion-icon>
                <span class="stat-number">0</span>
            </button>
            <div class="stat stat-view">
                <ion-icon name="eye-outline"></ion-icon>
                <span class="stat-number">0</span>
            </div>
        </div>

        <h4 class="title t-4">Introduction to New Gold Protocol</h4>
        <p>
            <a href="https://whitepaper.newgoldprotocol.io/" target="_blank">New Gold Protocol</a> is a decentralized finance protocol built
            on Binance Chain, launched on September 18, 2025, with the stated goal of becoming a "next-generation DeFi 3.0" platform. It aimed 
            to create an inclusive, transparent, and automated staking environment using smart contracts, promoting its native token as 
            deflationary through token burns and promising real-yield distributions instead of speculative incentives. The protocol was 
            designed to achieve transparency, fairness, and sustainability through AI optimization, setting a new benchmark for staking protocols.
            However, the protocol was exploited just hours after its launch, resulting in the theft of approximately $2 million in assets from its liquidity pool.
        </p>

        <h4 class="title t-4">Decoding Contract Logic Flaws</h4>
        <p>
            The attack exploited critical compounded vulnerabilities in NGP's core smart contract logic primarily because of price oracle manipulation.
        </p>


        <h5 class="subtitle s-5">What is a Price Oracle Manipulation?</h5>
        <p>
            Price Oracle Manipulation is a critical vulnerability in smart contracts that rely on oracles to fetch price and provide
            real-world data to smart contracts. However, attackers can exploit oracles by manipulating the data they supply, leading to devastating 
            consequences such as unauthorized withdrawals, excessive leverage, or even draining liquidity pools.
        </p>


        <h4 class="title t-4">Smart Contract vulnerabilities</h4>
        <ol class="outer-ol">
            <li>
                <span class="ol-title">
                    <a href="https://bscscan.com/address/0xd2f26200cd524db097cf4ab7cc2e5c38ab6ae5c9#code#F1#L357" target="_blank">getPrice()</a> function:
                </span>
                <span class="ol-expl">
                    which basically wraps the price returned by external function <code class="inline-snippet">getTokenPrice</code>.
                    <figure class="a-figure zoom-s">
                        <img alt="small zoom" src="../../images/blog/security/new-gold-protocol-hack-analysis/getPrice.png">
                    </figure>
                </span>

                <!----- FIRST NESTED LIST --------->
                <ol class="inner-ol">
                    <li>
                        <span class="ol-title">
                            <a href="https://bscscan.com/address/0xd2f26200cd524db097cf4ab7cc2e5c38ab6ae5c9#code#F1#L332" target="_blank">getTokenPrice()</a> function, which:
                        </span>
                        <span class="ol-expl">
                            <figure class="a-figure zoom-s">
                                <img alt="small zoom" src="../../images/blog/security/new-gold-protocol-hack-analysis/getPriceToken.png">
                            </figure>
                        </span>

                        <!----- SECOND NESTED LIST --------->
                        <ol class="inner-ol">
                            <li>
                                <span class="ol-title">
                                    Read directly the current reserves of NGP-USDT pair on Uniswap v2.
                                </span>
                                <span class="ol-expl">
                                    <div class="codebox">
                                        <button class="copy-btn" data-copy-target="#code-install" aria-label="Copy code"><ion-icon name="copy-outline"></ion-icon></button>
                                        <pre><code id="code-install">
                                            IUniswapV2Pair pair = IUniswapV2Pair(mainPair);
                                            (uint reserve0, uint reserve1, ) = pair.getReserves();
                                        </code></pre>
                                    </div>
                                </span>
                            </li>
                            <li>
                                <span class="ol-title">
                                    Used the simple pool ratio of of USDT reserve to NGP reserve to calculate the token's price.
                                </span>
                                <span class="ol-expl">
                                    <div class="copyline">
                                        <code id="code-rpc">price = (usdtReserve * 1e18) / tokenReserve;</code>
                                        <button class="copy-btn" data-copy-target="#code-rpc" aria-label="Copy line"><ion-icon name="copy-outline"></ion-icon></button>
                                    </div>
                                </span>
                            </li>
                        </ol>
                    </li>
                </ol>
            </li>
            <li>
                <span class="ol-title">
                    <a href="https://bscscan.com/address/0xd2f26200cd524db097cf4ab7cc2e5c38ab6ae5c9#code#F1#L78" target="_blank">Whitelisted Addresses</a>
                </span>
                <ol class="inner-ol">
                    <li>
                        <span class="ol-title">
                            The protocol had a constant <code class="inline-snippet">DEAD</code> address:
                        </span>
                        <span class="ol-expl">
                            <div class="copyline">
                                <code id="code-rpc">address constant DEAD = 0x000000000000000000000000000000000000dEaD</code>
                                <button class="copy-btn" data-copy-target="#code-rpc" aria-label="Copy line"><ion-icon name="copy-outline"></ion-icon></button>
                            </div>
                        </span>
                    </li>
                    <li>
                        <span class="ol-title">
                            The protocol stored a mapping of <code class="inline-snippet">whitelisted</code> addresses:
                        </span>
                        <span class="ol-expl">
                            <div class="copyline">
                                <code id="code-rpc">mapping(address => bool) public whitelisted</code>
                                <button class="copy-btn" data-copy-target="#code-rpc" aria-label="Copy line"><ion-icon name="copy-outline"></ion-icon></button>
                            </div>
                        </span>
                    </li>
                    <li>
                        <span class="ol-title">
                            In constructor the <code class="inline-snippet">DEAD</code> was listed as <code class="inline-snippet">whitelisted</code> address along with protocol and mintAddress:
                        </span>
                        <span class="ol-expl">
                            <div class="codebox">
                                <button class="copy-btn" data-copy-target="#code-install" aria-label="Copy code"><ion-icon name="copy-outline"></ion-icon></button>
                                <pre><code id="code-install">
                                    whitelisted[address(this)] = true;
                                    whitelisted[address(DEAD)] = true;
                                    whitelisted[mintAddress] = true;
                                </code></pre>
                            </div>
                        </span>
                    </li>
                    <li>
                        <span class="ol-title">
                            Whitelisting <code class="inline-snippet">DEAD</code> address enabled the attacker of bypassing key restrictions and limitations set by contract logic including but not limited to:
                        </span>
                        <ul>
                            <li>limit on max buying <code class="inline-snippet">maxBuyAmountInUsdt</code> which is 10_000.</li>
                            <li>max buy count in 24 hours <code class="inline-snippet">maxBuyPerDay</code> which is 3 per day.</li>
                            <li>transfer cooldown after buy <code class="inline-snippet">transferCooldown</code> which is 30 mins.</li>
                        </ul>
                    </li>
                </ol>
            </li>
            <li>
                <span class="ol-title">
                    <a href="https://bscscan.com/address/0xd2f26200cd524db097cf4ab7cc2e5c38ab6ae5c9#code#F1#L249" target="_blank">_update()</a> function:
                </span>
                <span class="ol-expl">
                    <figure class="a-video zoom-m">
                        <video autoplay muted loop playsinline preload="auto">
                            <source src="../../images/blog/security/new-gold-protocol-hack-analysis/updateVideo.mp4" type="video/mp4">
                        </video>
                        <figcaption>`_update` function video</figcaption>
                    </figure>
                </span>

                <ol class="inner-ol">
                    <li>
                        <span class="ol-title">
                            Check if <code class="inline-snippet">from</code> or <code class="inline-snippet">to</code> are whitelisted addresses:
                        </span>
                        <span class="ol-expl">
                            <figure class="a-figure zoom-m">
                                <img alt="medium zoom" src="../../images/blog/security/new-gold-protocol-hack-analysis/whitelist.png">
                            </figure>
                        </span>

                        <ol class="inner-ol">
                            <li>
                                <span class="ol-title">
                                    Anyone can transfer from/to `0x...dEaD` as if it were a system contract.
                                </span>
                                <span class="ol-expl">
                                    <div class="copyline">
                                        <code id="code-rpc">if (whitelisted[from] || whitelisted[to])</code>
                                        <button class="copy-btn" data-copy-target="#code-rpc" aria-label="Copy line"><ion-icon name="copy-outline"></ion-icon></button>
                                    </div>
                                </span>
                            </li>
                            <li>
                                <span class="ol-title">
                                    Attacker utilized <code class="inline-snippet">DEAD</code> address as a bypass 
                                    gateway to initially route huge volumes of tokens to skip fee deductions, buy/sell caps, and cooldowns.
                                </span>
                            </li>
                        </ol>
                    </li>
                    <li>
                        <span class="ol-title">
                            Buy NGP or Remove Liquidity Logic:
                        </span>
                        <span class="ol-expl">
                            <figure class="a-figure zoom-m">
                                <img alt="medium zoom" src="../../images/blog//security/new-gold-protocol-hack-analysis/buyNGP.png">
                            </figure>
                        </span>
                        <ol class="inner-ol">
                            <li>
                                <span class="ol-title">
                                    The spot price feed from <code class="inline-snippet">getPrice</code> was used in <code class="inline-snippet">_update</code> 
                                    function to enforce limitation on the maximum purchase amounts <code class="inline-snippet">maxBuyAmountInUsdt</code>

                                </span>
                                <span class="ol-expl">
                                    <div class="copyline">
                                        <code id="code-rpc">require(((value * getPrice()) / 1e18) <= maxBuyAmountInUsdt, "Exceeds max buy amount");</code>
                                        <button class="copy-btn" data-copy-target="#code-rpc" aria-label="Copy line"><ion-icon name="copy-outline"></ion-icon></button>
                                    </div>
                                </span>
                            </li>
                            <li>
                                <span class="ol-title">
                                    The price from a single DEX can easily and dramatically manipulate the pool's reserve within a single atomic transaction using a flash loan
                                    to inflate or deflate a token price causing <code class="inline-snippet">getPrice</code> function to report misleading low or high prices 
                                    which can allow the attacker to bypass the purchase limits that were supposedly to be enforced by contract logic.
                                </span>
                            </li>
                        </ol>
                    </li>
                    <li>
                        <span class="ol-title">
                            Sell NGP or Add Liquidity Logic:
                        </span>
                        <span class="ol-expl">
                            <figure class="a-figure zoom-m">
                                <img alt="medium zoom" src="../../images/blog/security/new-gold-protocol-hack-analysis/sellNGP.png">
                            </figure>
                        </span>
        
                        <p>Selling NGP triggered the contract logic to deduct set of fees as follows:</p>

                        <ul class="inner-ul">
                            <li><span class="ul-title">Market Fee Rate: 3%</span></li>
                            <li><span class="ul-title">Burn Fee Rate: 2%</span></li>
                            <li><span class="ul-title">Treasury Fee Rate: 10%</span></li>
                            <li><span class="ul-title">Reward Fee Rate: 60%</span></li>
                        </ul>
                        <ol class="inner-ol">
                            <li>
                                <span class="ol-title">
                                    Instead of deducting the tokens from seller's balance and transferring the remainder, the protocol 
                                    directly reduced tokens from the <strong>liquidity pool</strong>, followed by executing 
                                    <code class="inline-snippet">sync()</code> function then transfer seller's tokens as detailed below:
                                </span>
                            </li>
                            <ol class="inner-ol">
                                <li>
                                    <span class="ol-title">
                                        Liquidity Pool Burning Mechanism <a href="https://bscscan.com/address/0xd2f26200cd524db097cf4ab7cc2e5c38ab6ae5c9#code#F1#L322" target="_blank">isLpStopBurn():</a>
                                    </span>
                                    <span class="ol-expl">
                                        This function is a switch that decides whether tokens should still be burned to the DEAD address or whether burning should stop.
                                    </span>
                                    <ul class="inner-ul">
                                        <li>
                                            <span class="ul-title">
                                                If <code class="inline-snippet">lpBurnEnabled</code> is false, then burning is disabled.
                                            </span>
                                        </li>
                                        <li>
                                            <span class="ul-title">
                                                If <code class="inline-snippet">lpBurnEnabled</code> is true, then it calculates how many tokens are left in circulation: 
                                                <code class="inline-snippet">surplusAmount = totalSupply - burnedSupply</code>; if the remaining supply is below 10 million 
                                                tokens, it returns true and stop burning, otherwise it returns false and keep burning.
                                            </span>
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    <span class="ol-title">
                                        In <code class="inline-snippet">_update()</code>function when someone sells, it calculates the burn fee:
                                    </span>
                                    <span class="ol-expl">
                                        <div class="copyline">
                                            <code id="code-rpc">burnAmount = (value * burnFeeRate) / RATIO_PRECISION</code>
                                            <button class="copy-btn" data-copy-target="#code-rpc" aria-label="Copy line"><ion-icon name="copy-outline"></ion-icon></button>
                                        </div>
                                    </span>
                                    <ul class="inner-ul">
                                        <li>
                                            <span class="ul-title">
                                                If burning is still allowed tokens are taken from seller address <code class="inline-snippet">from</code> to the <code class="inline-snippet">DEAD</code> address to be burned
                                            </span>
                                            <span class="ul-expl">
                                                <div class="copyline">
                                                    <code id="code-rpc">isLpStopBurn() == false</code>
                                                    <button class="copy-btn" data-copy-target="#code-rpc" aria-label="Copy line"><ion-icon name="copy-outline"></ion-icon></button>
                                                </div>
                                            </span>
                                        </li>
                                        <li>
                                            <span class="ul-title">
                                                If burning has been instead of burning, the same fee is taken from the seller address <code class="inline-snippet">from</code> and rerouted to the <code class="inline-snippet">marketAddress</code>
                                            </span>
                                            <span class="ul-expl">
                                                <div class="copyline">
                                                    <code id="code-rpc">isLpStopBurn() == true</code>
                                                    <button class="copy-btn" data-copy-target="#code-rpc" aria-label="Copy line"><ion-icon name="copy-outline"></ion-icon></button>
                                                </div>
                                            </span>
                                        </li>
                                        <li>
                                            <span class="ul-title">
                                                Burning mechanism is designed to either deflationary (burn) tokens or treasury-build (reroute).
                                            </span>
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    <span class="ol-title">Market Fee:</span>
                                    <span class="ol-expl">
                                        <div class="codebox">
                                            <button class="copy-btn" data-copy-target="#code-install" aria-label="Copy code"><ion-icon name="copy-outline"></ion-icon></button>
                                            <pre><code id="code-install">
                                                marketFee = (value * marketFeeRate) / RATIO_PRECISION
                                                super._update(from, marketAddress, marketFee)
                                            </code></pre>
                                        </div>
                                    </span>
                                    <ul class="inner-ul">
                                        <li>
                                            <span class="ul-title">
                                                Separately from the burn, the market fee is always taken from seller address <code class="inline-snippet">from</code> and sent to the protocol’s <code class="inline-snippet">marketAddress</code>.
                                            </span>
                                        </li>
                                        <li>
                                            <span class="ul-title">
                                                This means the <code class="inline-snippet">marketAddress</code> always receives at least <code class="inline-snippet">marketFee</code>,
                                                and sometimes also the <code class="inline-snippet">burnAmount</code> if burning is disabled.
                                            </span>
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    <span class="ol-title">Treasury and Reward Fees:</span>
                                    <span class="ol-expl">
                                        <div class="copyline">
                                            <code id="code-rpc">burnPoolAmount = treasuryAmount + rewardAmount;</code>
                                            <button class="copy-btn" data-copy-target="#code-rpc" aria-label="Copy line"><ion-icon name="copy-outline"></ion-icon></button>
                                        </div>
                                    </span>
                                    <ul class="inner-ul">
                                        <li>
                                            <span class="ul-title">
                                                I personally find this naming confusing and misleading, but upon code investigation you can figure out why it was given that name.
                                                it's the sum of <code class="inline-snippet">treasuryAmount</code> and <code class="inline-snippet">rewardAmount</code>
                                                that the protocol mistakenly deducted from the pool reserves directly instead of deducting it from the seller address <code class="inline-snippet">from</code>. 
                                                The protocol checks if pool has enough balance to cover sum of <code class="inline-snippet">treasuryAmount</code> and <code class="inline-snippet">rewardAmount</code> and if it does:
                                            </span>
                                        </li>
                                        <li>
                                            <span class="ul-title">
                                                It deducts <code class="inline-snippet">treasuryAmount</code> from pool's balance directly
                                            </span>
                                            <span class="ul-expl">
                                                <div class="copyline">
                                                    <code id="code-rpc">super._update(mainPair, treasuryAddress, treasuryAmount);</code>
                                                    <button class="copy-btn" data-copy-target="#code-rpc" aria-label="Copy line"><ion-icon name="copy-outline"></ion-icon></button>
                                                </div>
                                            </span>
                                        </li>
                                        <li>
                                            <span class="ul-title">
                                                It deducts <code class="inline-snippet">rewardAmount</code> from pool's balance directly
                                            </span>
                                            <span class="ul-expl">
                                                <div class="copyline">
                                                    <code id="code-rpc">super._update(mainPair, rewardPoolAddress, rewardAmount);</code>
                                                    <button class="copy-btn" data-copy-target="#code-rpc" aria-label="Copy line"><ion-icon name="copy-outline"></ion-icon></button>
                                                </div>
                                            </span>
                                        </li>
                                        <li>
                                            <span class="ul-title">
                                                And last, it synchronize the pool state with current changes after deduction!
                                            </span>
                                            <span class="ul-expl">
                                                This leads to liquidity to financial losses for liquidity providers and price manipulation due to altered reserves and imbalanced. 
                                            </span>
                                        </li>
                                    </ul>
                                </li>
                            </ol>
                        </ol>
                    </li>
                </ol>
            </li>
        </ol>
        

        <h4 class="title t-4">Hack Analysis</h4>
        <p>
            
            Attacker combined all above vulnerabilities in a single atomic transaction of manipulating the price via flash loan, bypassing buy limits through 
            the whitelist, and exploiting premature fee and sync logic to sell at an inflated price.
        </p>
        <ul>
            <li>
                Initially attacker swapped funds on PancakeSwap for NGP using several EOAs.
                <figure class="a-figure zoom-m">
                    <img alt="medium zoom" src="../../images/blog/security/new-gold-protocol-hack-analysis/transfer.png">
                </figure>
            </li>
            <li>
                Then took a BTCB flash loan from Moolah protocol to use it as a collateral on Venus protocol to borrow vUSDT.
                <figure class="a-figure zoom-m">
                    <img alt="medium zoom" src="../../images/blog/security/new-gold-protocol-hack-analysis/flashLoanVenus.png">
                </figure>
            </li>
            <li>
                Then drawing liquidity from various liquidity pools by several flash loans of BSC-USD from PancakeSwap.
                <figure class="a-figure zoom-m">
                    <img alt="medium zoom" src="../../images/blog/security/new-gold-protocol-hack-analysis/BSC-USD.png">
                </figure>
            </li>
            <li>
                Then attacker swapped BSC-USD for NGP in the PancakeSwap pool while setting the recipient address to the whitelisted `DEAD` 
                address to avoid all NGP restrictions and manipulated the NGP-USDT `getPrice` function to buy the NGP token at artificially low price.
                <figure class="a-figure zoom-m">
                    <img alt="medium zoom" src="../../images/blog/security/new-gold-protocol-hack-analysis/NGP.png">
                </figure>
            </li>
            <li>
                Next, attacker utilized the transaction fee being deducted from DEX not from seller vulnerability to inflate the token price by 
                executing series of swaps using NGP balance to deplete BSC-USD pool entirely after repaying all borrowed tokens while gaining net profit of $2M.
                <figure class="a-figure zoom-m">
                    <img alt="medium zoom" src="../../images/blog/security/new-gold-protocol-hack-analysis/smallSwaps.png">
                </figure>
            </li>
            <li>
                Attacker swapped stolen BSC-USD for ETH on KyberSwap.
                <figure class="a-figure zoom-m">
                    <img alt="medium zoom" src="../../images/blog/security/new-gold-protocol-hack-analysis/KyberSwap.png">
                </figure>
            </li>
            <li>
                After Successfully acquiring ETH on BNB chain, attacker bridged entire ETH balance to Ethereum chain using Across protocol.
                <figure class="a-figure zoom-m">
                    <img alt="medium zoom" src="../../images/blog/security/new-gold-protocol-hack-analysis/Across.png">
                </figure>
            </li>
            <li>
                Attacker's final step to conceal his crime, he used Tornado Cash to make tracing stolen funds more difficult.
                <figure class="a-figure zoom-m">
                    <img alt="medium zoom" src="../../images/blog/security/new-gold-protocol-hack-analysis/Tornado.png">
                </figure>
            </li>
        </ul>

        <h4 class="title t-4">Root Cause Summary</h4>
        <ol>
            <li>
                <strong>Flash Loan Oracle Manipulation:</strong> Relied on instantaneous spot reserves from 
                a single DEX (NGP-USDT pair) as the sole oracle source, making it trivial to distort price via 
                flash loans.
            </li>
            <li>
                <strong>Simplistic Price Calculation:</strong> Used a direct reserve ratio for pricing, 
                which amplified the effect of manipulated reserves and let the attacker buy tokens at 
                artificially low values.
            </li>
            <li>
                <strong>Whitelisted DEAD Address:</strong> Allowed trades routed through the burn address 
                to bypass buy/sell limits, cooldowns, and fee enforcement, removing key protections.
            </li>
            <li>
                <strong>Fee Deduction from LP Reserves:</strong> Treasury and reward fees were extracted 
                directly from liquidity pool reserves instead of seller balances, breaking AMM invariants 
                and depleting liquidity.
            </li>
            <li>
                <strong>Misuse of Burn Logic:</strong> `isLpStopBurn()` redirected intended burn amounts 
                to the protocol’s market address, undermining token supply deflation and concentrating supply control.
            </li>
            <li>
                <strong>Abuse of sync():</strong> Forced synchronization after reserve manipulation locked 
                in distorted pool balances as legitimate prices, compounding the exploit’s profitability.
            </li>
        </ol>

        <h4 class="title t-4">Post-Hack Mitigation</h4>
        <p>
            Following the exploit, the New Gold Protocol team acknowledged the incident publicly on September 20, 2025, 
            stating their intent to continue the project and relaunch. However, no concrete remediation steps 
            were provided: no contract upgrades, audits, or restitution plans were announced. Communication 
            was limited to a few posts on X about tracking the attacker’s funds and “resuming activities soon,” 
            leaving users without clear guidance and liquidity severely impacted.
        </p>

        <div style="display:flex; justify-content:center;">
            <blockquote class="twitter-tweet">
                <p lang="en" dir="ltr">
                    If any organization is willing to track down the hackers, please do so<br>
                    Crypto scene is still new and rules are still being stabilized. <br>
                    <br>Again we emphasize: we will be back.
                </p>&mdash; New Gold Protocol (@newgoldprotocol)
                <a href="https://twitter.com/newgoldprotocol/status/1969317190974521754?ref_src=twsrc%5Etfw">September 20,
                    2025</a>
            </blockquote>
            <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
        </div>

        <h4 class="title t-4">Strategic Remediation Plan- Recommendations if I Were Leading Response</h4>
        <ol>
            <li>
                <strong>Immediate Triage:</strong> Suspend trading, halt pool interactions, and prevent further depletion.
            </li>
            <li>
                <strong>Whitelist Audit:</strong> Remove `DEAD` and other system addresses from privileged lists.
            </li>
            <li>
                <strong>Oracle Hardening:</strong> Integrate TWAP (Time-Weighted Average Price) instead of relying 
                on instantaneous pool reserves, and enforce price guards to block extreme deviations. 
                External feeds (e.g., Chainlink) can complement but should not replace robust in-protocol safeguards.
            </li>
            <li>
                <strong>Fee Rework:</strong> Ensure all fees (market, burn, treasury, reward) are charged exclusively 
                from seller transfers.
            </li>
            <li>
                <strong>Testing & Simulation:</strong> Run adversarial stress tests on forked mainnet environments 
                with flash-loan scenarios, leveraging<a href="https://updraft.cyfrin.io/courses/foundry" target="_blank">Foundry fuzzing</a> to surface edge cases and logic breaks before redeployment.
            </li>
            <li>
                <strong>Community Communication:</strong> Publish a forensic report, outline audited redeploy 
                plans, and define restitution pathways to restore user trust.
            </li>
        </ol>

        <h4 class="title t-4">Security Takeaways</h4>
        <ul>
            <li>🧩 Flash loans + raw AMM reserves = guaranteed oracle manipulation.</li>
            <li>🧩 Never whitelist “dead” or sink addresses.</li>
            <li>🧩 Preserve AMM invariants: pool reserves must only move via trades, not protocol logic.</li>
            <li>🧩 Every fee mechanism must be modeled under adversarial scenarios.</li>
            <li>🧩 Post-exploit recovery is as much about user trust as it is about code fixes.</li>
        </ul>

        <h4 class="title t-4">Incident Report Table</h4>
        
        <div class="legend legend-center">
        
            <div class="legend-section">
                <div class="legend-sub-title">Severity</div>
                <div class="legend-row">
                    <span class="sev-critical">Critical</span>
                    <span class="legend-expl">Direct funds drainage or take control of protocol.</span>
                </div>

                <div class="legend-row">
                    <span class="sev-high">High</span>
                    <span class="legend-expl">Severe losses or control issues with some conditions.</span>
                </div>

                <div class="legend-row">
                    <span class="sev-medium">Medium</span>
                    <span class="legend-expl">Issues that degrade security or amplify bugs.</span>
                </div>

                <div class="legend-row">
                    <span class="sev-low">Low</span>
                    <span class="legend-expl">Minor edge cases &amp; small impact.</span>
                </div>

                <div class="legend-row">
                    <span class="sev-info">Informational</span>
                    <span class="legend-expl">No direct exploit, but harmful to trust.</span>
                </div>
            </div>

            <div class="legend-section">
                <div class="legend-sub-title">Impact</div>
                <div class="legend-row">
                    <span class="impact-high">High</span>
                    <span class="legend-expl">Directly enabled liquidity drain, major financial loss.</span>
                </div>

                <div class="legend-row">
                    <span class="impact-medium">Medium</span>
                    <span class="legend-expl">Amplified exploit or weakened tokenomics.</span>
                </div>

                <div class="legend-row">
                    <span class="impact-low">Low</span>
                    <span class="legend-expl">Limited effect, cosmetic, or edge-case outcome.</span>
                </div>
            </div>

            <div class="legend-section">
                <div class="legend-sub-title">Likelihood</div>
                <div class="legend-row">
                    <span class="likely-high">High</span>
                    <span class="legend-expl">Trivial to exploit or already weaponized in attack.</span>
                </div>

                <div class="legend-row">
                    <span class="likely-medium">Medium</span>
                    <span class="legend-expl">Requires conditions or chaining but practical.</span>
                </div>

                <div class="legend-row">
                    <span class="likely-low">Low</span>
                    <span class="legend-expl">Edge cases, rare alignment, or theoretical.</span>
                </div>
            </div>
        
            <div class="legend-section">
                <div class="legend-sub-title">Status</div>
                <div class="legend-row">
                    <span class="status-exploited">Exploited</span>
                    <span class="legend-expl">Confirmed used in the $2M NGP hack.</span>
                </div>
                <div class="legend-row">
                    <span class="status-contributed">Contributed</span>
                    <span class="legend-expl">Amplified the overall exploit.</span>
                </div>
                <div class="legend-row">
                    <span class="status-design">Design Risk</span>
                    <span class="legend-expl">Introduces structural weakness.</span>
                </div>
            </div>
            
        </div>

        
        <table class="incident-table">
            <thead>
                <tr>
                    <th>Severity</th>
                    <th>Likelihood</th>
                    <th>Status</th>
                    <th>Impact</th>
                    <th>Vulnerability</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><span class="sev-critical">Critical</span></td>
                    <td><span class="likely-high">High</span></td>
                    <td><span class="status-exploited">Exploited</span></td>
                    <td><span class="impact-high">High</span></td>
                    <td>Flash Loan Oracle Manipulation<br><a href="https://bscscan.com/address/0xd2f26200cd524db097cf4ab7cc2e5c38ab6ae5c9#code#F1#L338" target="_blank">pair.getReserves()</a></td>
                    <td>Relied on a single DEX pool’s spot reserves, allowing attacker to distort NGP-USDT price via flash loans and sell at inflated valuations.</td>
                </tr>
                <tr>
                    <td><span class="sev-critical">Critical</span></td>
                    <td><span class="likely-high">High</span></td>
                    <td><span class="status-exploited">Exploited</span></td>
                    <td><span class="impact-high">High</span></td>
                    <td>Fee Deduction from LP Reserves Directly<br>
                        <a href="https://bscscan.com/address/0xd2f26200cd524db097cf4ab7cc2e5c38ab6ae5c9#code#F1#L297" target="_blank">Treasury Fees</a><br>
                        &<br> <a href="https://bscscan.com/address/0xd2f26200cd524db097cf4ab7cc2e5c38ab6ae5c9#code#F1#L299" target="_blank">Reward Fees</a>
                    </td>
                    <td>Treasury/reward fees deducted from liquidity pool reserves instead of seller balances, breaking AMM invariant and directly draining pool.</td>
                </tr>
                <tr>
                    <td><span class="sev-high">High</span></td>
                    <td><span class="likely-high">High</span></td>
                    <td><span class="status-exploited">Exploited</span></td>
                    <td><span class="impact-high">High</span></td>
                    <td>Whitelisted DEAD Address<br><a href="https://bscscan.com/address/0xd2f26200cd524db097cf4ab7cc2e5c38ab6ae5c9#code#F1#L256">Whitelisted<br> `from` & `to`</a></td>
                    <td>Enabled bypass of buy caps, cooldowns, and fee checks, allowing attacker to execute unrestricted swaps via DEAD address.</td>
                </tr>
                <tr>
                    <td><span class="sev-high">High</span></td>
                    <td><span class="likely-high">High</span></td>
                    <td><span class="status-exploited">Exploited</span></td>
                    <td><span class="impact-high">High</span></td>
                    <td>Simplistic Price Calculation<br><a href="https://bscscan.com/address/0xd2f26200cd524db097cf4ab7cc2e5c38ab6ae5c9#code#F1#L346">L 346</a></td>
                    <td>Used a raw reserve ratio without TWAP/guards, making price trivial to manipulate during reserve imbalance.</td>
                </tr>
                <tr>
                    <td><span class="sev-medium">Medium</span></td>
                    <td><span class="likely-medium">Medium</span></td>
                    <td><span class="status-contributed">Contributed</span></td>
                    <td><span class="impact-medium">Medium</span></td>
                    <td>Burn Logic Misuse<br><a href="https://bscscan.com/address/0xd2f26200cd524db097cf4ab7cc2e5c38ab6ae5c9#code#F1#L284">isLpStopBurn()</a></td>
                    <td>Redirected intended burns to market wallet, undermining supply deflation and compounding supply centralization during attack.</td>
                </tr>
                <tr>
                    <td><span class="sev-medium">Medium</span></td>
                    <td><span class="likely-medium">Medium</span></td>
                    <td><span class="status-contributed">Contributed</span></td>
                    <td><span class="impact-medium">Medium</span></td>
                    <td>Abuse of sync()<br><a href="https://bscscan.com/address/0xd2f26200cd524db097cf4ab7cc2e5c38ab6ae5c9#code#F1#L300">sync()</a></td>
                    <td>Locked manipulated reserves as valid pool state, inflating false price and amplifying profitability of attacker’s swaps.</td>
                </tr>
                <tr>
                    <td><span class="sev-info">Info<br>rmational</span></td>
                    <td><span class="likely-low">Low</span></td>
                    <td><span class="status-design">Design Risk</span></td>
                    <td><span class="impact-low">Low</span></td>
                    <td>Misleading Naming of Tokens Redistributions<br><a href="https://bscscan.com/address/0xd2f26200cd524db097cf4ab7cc2e5c38ab6ae5c9#code#F1#L293">burnPoolAmount</a></td>
                    <td>Misnamed variable suggests burning, but actually redistributes tokens, confusing devs and auditors.</td>
                </tr>
            </tbody>
        </table>


        <section class="audit-promo">
            <div class="audit-inner">
                <h3>Level Up Your Security Skills with Cyfrin Updraft</h3>
                <p>
                    A hands-on smart contract security education platform designed to help developers, auditors, and protocol teams 
                    master adversarial thinking through challenges, tutorials, and real-world exploit case studies.
                </p>
                <a class="audit-btn" href="https://updraft.cyfrin.io/courses" target="_blank" rel="noopener noreferrer">
                    Start Learning
                </a>
            </div>
        </section>
        
    </div>

    <form name="subscribe-form" method="POST" data-netlify="true" netlify-honeypot="bot-field" hidden>
        <input type="hidden" name="form-name" value="subscribe-form">
        <input type="text" name="bot-field">
        <input type="email" name="email">
    </form>

    <div class="modal-overlay" data-subscribe-modal hidden>
        <div class="modal-window" role="dialog" aria-modal="true" aria-labelledby="subscribeModalTitle">
            <button type="button" class="modal-close" data-close-subscribe aria-label="Close subscribe dialog">&times;</button>
            <h3 id="subscribeModalTitle" class="modal-title">Receive new articles directly in your inbox</h3>
            <form class="modal-form" data-subscribe-form>
                <label class="visually-hidden" for="subscribe-email">Email</label>
                <input type="email" id="subscribe-email" name="email" placeholder="enter your email" autocomplete="email" required>
                <span class="input-hint" data-subscribe-hint></span>
                <button type="submit" class="modal-submit" data-subscribe-submit disabled>subscribe</button>
                <p class="submit-feedback" data-subscribe-feedback role="status" aria-live="polite"></p>
            </form>
        </div>
    </div>

    <div class="modal-overlay" data-connect-modal hidden>
        <div class="modal-window modal-window--wallet" role="dialog" aria-modal="true" aria-labelledby="walletModalTitle" id="walletModal">
            <button type="button" class="modal-close" data-close-connect aria-label="Close wallet dialog">&times;</button>
            <h3 id="walletModalTitle" class="modal-title">Connect your wallet</h3>
            <p class="modal-intro">Select a wallet provider to continue. (Wallet integration coming soon.)</p>
            <ul class="wallet-list">
                <li><button type="button" class="wallet-button" data-wallet="metamask">MetaMask</button></li>
                <li><button type="button" class="wallet-button" data-wallet="coinbase">Coinbase Wallet</button></li>
                <li><button type="button" class="wallet-button" data-wallet="trust">Trust Wallet</button></li>
                <li><button type="button" class="wallet-button" data-wallet="phantom">Phantom</button></li>
                <li><button type="button" class="wallet-button" data-wallet="rainbow">Rainbow</button></li>
                <li><button type="button" class="wallet-button" data-wallet="ledger">Ledger Live</button></li>
            </ul>
            <p class="wallet-placeholder-note">Connection support will arrive soon. For now, this list is a visual placeholder.</p>
        </div>
    </div>

    <footer>
        <div class="footer-content">
            <p>&copy; 2025 Sasha Flores. All Rights Reserved.</p>
            <div class="social-links">
                <a href="https://www.linkedin.com/in/sflores369/" target="_blank"><ion-icon name="logo-linkedin"></ion-icon></a>
                <a href="https://discord.com/users/827160247428710422" target="_blank"><ion-icon name="logo-discord"></ion-icon></a>
                <a href="https://github.com/SashaFlores" target="_blank"><ion-icon name="logo-github"></ion-icon></a>
                <a href="https://www.youtube.com/@web3securityengineer" target="_blank"><ion-icon name="videocam-sharp"></ion-icon><span class="tooltip"></span></a>
            </div>
        </div>
    </footer>
    
    
    
    <script src="../../js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="../../js/aos.js"></script>
    <script src="../../js/custom.js"></script>
    <script src="../../js//code-copy.js"> </script>
    <script src="../../js/post-slugs.js" defer></script>
    <script>window.POST_STATS_API_BASE = 'https://sashaflores-portfolio.vercel.app';</script>
    <script src="../../js/post-stats.js" defer></script>
    <script src="../../js/nav-cta.js" defer></script>
    
   
    
    <script type="module" src="https://unpkg.com/ionicons@latest/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule="" src="https://unpkg.com/ionicons@latest/dist/ionicons/ionicons.js"></script>

    </body>
</html>